<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EV Sales Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
  </head>
  <body>
    <div class="container">
      <header>
        <h1>EV Sales Dashboard</h1>
        <p class="subtitle">Select a manufacturer to view 2026 predictions and changes</p>
      </header>

      <nav class="dash-nav">
        <button id="view-overview" class="nav-btn active">Overview</button>
        <button id="view-insights" class="nav-btn">Insights</button>
        <button id="view-visuals" class="nav-btn">Data Visuals</button>
      </nav>

      <div class="controls">
        <label for="manufacturer">Manufacturer</label>
        <select id="manufacturer">
          <option value="">-- select --</option>
          {% for m in manufacturers %}
            <option value="{{m}}" {% if result and result.Manufacturer==m %}selected{% endif %}>{{m}}</option>
          {% endfor %}
        </select>
      </div>

      <div id="card" class="card hidden">
        <h3 id="c-name"></h3>
        <div class="metrics">
          <div class="metric">
            <div class="m-title">Avg (2015-25)</div>
            <div id="m-avg" class="m-value">-</div>
          </div>
          <div class="metric">
            <div class="m-title">2026 Pred</div>
            <div id="m-pred" class="m-value">-</div>
          </div>
          <div class="metric">
            <div class="m-title">Change</div>
            <div id="m-change" class="m-value">-</div>
          </div>
          <div class="metric">
            <div class="m-title">Change %</div>
            <div id="m-change-pct" class="m-value">-</div>
          </div>
        </div>
        <div style="margin-top:20px; height:320px; border-top: 1px solid #e5e7eb; padding-top:16px;">
          <h4 style="margin-bottom:12px;">Selected Brand — Year-wise Sales</h4>
          <canvas id="brand-yearly" width="800" height="300"></canvas>
        </div>
      </div>

      <!-- Insights dashboard -->
      <div id="insights" class="panel hidden">
        <h2>Insights</h2>
        <div id="insights-summary" class="card">
          <p><strong>What this shows:</strong> Predicted change for each brand from the historical average (2015–2025) to the 2026 model prediction. Positive values indicate expected growth; negative values indicate decline.</p>
          <ul>
            <li>Use the bar chart to compare raw change across brands.</li>
            <li>Top gainers and losers are listed below for quick review.</li>
          </ul>
        </div>
        <div style="margin-top:12px; height:360px;" class="card">
          <canvas id="brands-bar" width="800" height="360"></canvas>
        </div>
        <div id="insights-list" style="margin-top:12px"></div>
      </div>

      <!-- Data.py visuals (line + bar charts) -->
      <div id="visuals" class="panel hidden">
        <h2>Visuals (Sales & Factors)</h2>
        <div class="card" style="margin-bottom:12px; height:280px;">
          <h4 style="margin-bottom:12px;">Sales vs Year</h4>
          <canvas id="visual-yearly" width="800" height="260"></canvas>
        </div>
        <div class="card" style="margin-bottom:12px; height:320px;">
          <h4 style="margin-bottom:12px;">Company vs Sales</h4>
          <canvas id="visual-top-manufacturers" width="800" height="300"></canvas>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/app.js"></script>
  </body>
</html>